<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SKHP4P</title>
    <link href="https://cdn.jsdelivr.net/npm/daisyui@5" rel="stylesheet" type="text/css" />
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
    <style>
        #nav,
        #dock,
        #load_main,
        #iframe {
            display: none;
        }
    </style>
</head>

<body>
    <div id="nav" class="navbar bg-base-100 shadow-sm outline-2 sticky top-0 z-10">
        <div class="navbar-start">
        </div>
        <div class="navbar-center">
            <div class="avatar pr-4">
                <div class="w-16 rounded-full">
                    <img id="profile_img" alt="profile_img" />
                </div>
            </div>
            <div class="grid grid-cols-1">
                <p id="profile_name" class="text-lg font-semibold"></p>
                <kdb class="kbd kbd-sm">logged in</kdb>
            </div>
        </div>
        <div class="navbar-end">
            <button class="btn btn-square btn-ghost focus:outline-1 focus:bg-base-100" onclick="modal.showModal()">
                <svg class="size-[2em]" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640">
                    <path
                        d="M569 337C578.4 327.6 578.4 312.4 569 303.1L425 159C418.1 152.1 407.8 150.1 398.8 153.8C389.8 157.5 384 166.3 384 176L384 256L272 256C245.5 256 224 277.5 224 304L224 336C224 362.5 245.5 384 272 384L384 384L384 464C384 473.7 389.8 482.5 398.8 486.2C407.8 489.9 418.1 487.9 425 481L569 337zM224 160C241.7 160 256 145.7 256 128C256 110.3 241.7 96 224 96L160 96C107 96 64 139 64 192L64 448C64 501 107 544 160 544L224 544C241.7 544 256 529.7 256 512C256 494.3 241.7 480 224 480L160 480C142.3 480 128 465.7 128 448L128 192C128 174.3 142.3 160 160 160L224 160z" />
                </svg>
            </button>
            <dialog id="modal" class="modal">
                <div class="modal-box">
                    <p class="py-4 text-lg lg:text-xl xl:text-xl">Do you want to log out ?</p>
                    <div class="modal-action">
                        <form method="dialog">
                            <button class="btn" onclick="logOut()">Yes</button>
                            <button class="btn">No</button>
                        </form>
                    </div>
                </div>
            </dialog>
        </div>
    </div>

    <div id="content" class="bg-base-300 min-h-screen flex flex-col items-center justify-center">
        <div id="load_init" class="loading loading-dots loading-xl"></div>
        <div id="load_main" class="loading loading-dots loading-lg"></div>
        <iframe id="iframe"
            data-tally-src="https://tally.so/embed/31LarW?hideTitle=1&transparentBackground=1&dynamicHeight=1"
            loading="lazy" width="100%" height="351" frameborder="0" marginheight="0" marginwidth="0"
            title="P4P - Upload"></iframe>
    </div>

    <div id="dock" class="dock bg-base-100 outline-2">
        <button id="button_status">
            <div class="flex">
                <svg class="size-[1.4em] mr-2" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640">
                    <path
                        d="M256 144C256 117.5 277.5 96 304 96L336 96C362.5 96 384 117.5 384 144L384 496C384 522.5 362.5 544 336 544L304 544C277.5 544 256 522.5 256 496L256 144zM64 336C64 309.5 85.5 288 112 288L144 288C170.5 288 192 309.5 192 336L192 496C192 522.5 170.5 544 144 544L112 544C85.5 544 64 522.5 64 496L64 336zM496 160L528 160C554.5 160 576 181.5 576 208L576 496C576 522.5 554.5 544 528 544L496 544C469.5 544 448 522.5 448 496L448 208C448 181.5 469.5 160 496 160z" />
                </svg>
                <div>STATUS</div>
            </div>
        </button>
        <button id="button_upload">
            <div class="flex">
                <svg class="size-[1.4em] mr-2" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640">
                    <path
                        d="M176 544C96.5 544 32 479.5 32 400C32 336.6 73 282.8 129.9 263.5C128.6 255.8 128 248 128 240C128 160.5 192.5 96 272 96C327.4 96 375.5 127.3 399.6 173.1C413.8 164.8 430.4 160 448 160C501 160 544 203 544 256C544 271.7 540.2 286.6 533.5 299.7C577.5 320 608 364.4 608 416C608 486.7 550.7 544 480 544L176 544zM337 255C327.6 245.6 312.4 245.6 303.1 255L231.1 327C221.7 336.4 221.7 351.6 231.1 360.9C240.5 370.2 255.7 370.3 265 360.9L296 329.9L296 432C296 445.3 306.7 456 320 456C333.3 456 344 445.3 344 432L344 329.9L375 360.9C384.4 370.3 399.6 370.3 408.9 360.9C418.2 351.5 418.3 336.3 408.9 327L336.9 255z" />
                </svg>
                <div>UPLOAD</div>
            </div>
        </button>
        <button id="button_sign">
            <div class="flex">
                <svg class="size-[1.4em] mr-2" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640">
                    <path
                        d="M320 96C239.2 96 174.5 132.8 127.4 176.6C80.6 220.1 49.3 272 34.4 307.7C31.1 315.6 31.1 324.4 34.4 332.3C49.3 368 80.6 420 127.4 463.4C174.5 507.1 239.2 544 320 544C400.8 544 465.5 507.2 512.6 463.4C559.4 419.9 590.7 368 605.6 332.3C608.9 324.4 608.9 315.6 605.6 307.7C590.7 272 559.4 220 512.6 176.6C465.5 132.9 400.8 96 320 96zM176 320C176 240.5 240.5 176 320 176C399.5 176 464 240.5 464 320C464 399.5 399.5 464 320 464C240.5 464 176 399.5 176 320zM320 256C320 291.3 291.3 320 256 320C244.5 320 233.7 317 224.3 311.6C223.3 322.5 224.2 333.7 227.2 344.8C240.9 396 293.6 426.4 344.8 412.7C396 399 426.4 346.3 412.7 295.1C400.5 249.4 357.2 220.3 311.6 224.3C316.9 233.6 320 244.4 320 256z" />
                </svg>
                <div>SNOOP</div>
            </div>
        </button>
    </div>

    <script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script>var d = document, w = "https://tally.so/widgets/embed.js", v = function () { "undefined" != typeof Tally ? Tally.loadEmbeds() : d.querySelectorAll("iframe[data-tally-src]:not([src])").forEach((function (e) { e.src = e.dataset.tallySrc })) }; if ("undefined" != typeof Tally) v(); else if (d.querySelector('script[src="' + w + '"]') == null) { var s = d.createElement("script"); s.src = w, s.onload = v, s.onerror = v, d.body.appendChild(s); }</script>
    <script>
        const nav = document.getElementById("nav")
        const dock = document.getElementById("dock")
        const content = document.getElementById("content")
        const load_init = document.getElementById("load_init")
        const load_main = document.getElementById("load_main")
        const iframe = document.getElementById("iframe")
        const button_status = document.getElementById("button_status")
        const button_upload = document.getElementById("button_upload")
        const button_sign = document.getElementById("button_sign")
        const profile_img = document.getElementById("profile_img")
        const profile_name = document.getElementById("profile_name")

        button_status.addEventListener("click", function (e) {
            this.classList.add("dock-active")
            button_upload.classList.remove("dock-active")
            button_sign.classList.remove("dock-active")
            iframe.style.display = "none"
            e.preventDefault()
        })

        button_upload.addEventListener("click", function (e) {
            this.classList.add("dock-active")
            button_status.classList.remove("dock-active")
            button_sign.classList.remove("dock-active")
            iframe.style.display = "block"
            e.preventDefault()
        })

        button_sign.addEventListener("click", function (e) {
            this.classList.add("dock-active")
            button_status.classList.remove("dock-active")
            button_upload.classList.remove("dock-active")
            iframe.style.display = "none"
            e.preventDefault()
        })

        function logOut() {
            if (liff.isLoggedIn()) {
                liff.logout()
            }
            window.location.replace("https://skhp4p.deno.dev/logout")
        }

        const logInLIFF = async () => {
            await liff.init({ liffId: "2007211330-ykKaQeJg" })
            if (liff.isLoggedIn()) {
                load_init.style.display = "none"
                nav.style.display = "flex"
                dock.style.display = "flex"
                content.classList.remove("justify-center")
                content.classList.add("pt-8", "md:pt-12", "lg:pt-16", "xl:pt-20")
                const profile = await liff.getProfile()
                profile_img.src = profile.pictureUrl
                profile_name.innerText = profile.displayName
                axios.get("https://skhp4p.deno.dev/sapi")
                    .then((response) => console.log(JSON.stringify(response.data)))
                    .catch((error) => console.error(error));
            } else {
                liff.login()
            }
        }
        logInLIFF();
    </script>

</body>

</html>